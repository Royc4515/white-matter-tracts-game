<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>White Matter Tracts Game</title>

<style>
  * {
    box-sizing: border-box;
    font-family: Arial, sans-serif;
  }

  body {
    margin: 0;
    height: 100vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    background: #f5f6fa;
  }

  /* ===== TOP BAR ===== */
  header {
    padding: 8px 12px;
    background: #2c3e50;
    color: white;
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 10px;
    font-size: 14px;
  }

  header button {
    padding: 6px 12px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
  }

  .btn {
    background: #3498db;
    color: white;
  }

  .btn.secondary {
    background: #95a5a6;
  }

  .btn.active {
    background: #1abc9c;
  }

  #status {
    margin-left: auto;
    font-weight: bold;
  }

  /* ===== MAIN LAYOUT ===== */
  main {
    flex: 1;
    display: grid;
    grid-template-columns: 1fr 1fr;
    padding: 10px;
    gap: 10px;
  }

  .zone {
    background: white;
    border-radius: 8px;
    padding: 10px;
    display: flex;
    flex-direction: column;
  }

  .zone h2 {
    text-align: center;
    margin: 5px 0 10px 0;
  }

  .drop-area {
    flex: 1;
    border: 2px dashed #ccc;
    border-radius: 6px;
    padding: 10px;
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    align-content: flex-start;
  }

  /* ===== OPTIONS ===== */
  #options {
    background: #ecf0f1;
    padding: 10px;
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    justify-content: center;
  }

  .item {
    background: #34495e;
    color: white;
    padding: 14px 18px;
    border-radius: 6px;
    cursor: grab;
    user-select: none;
    font-size: 20px;
  }

  .correct {
    background: #2ecc71 !important;
  }

  .wrong {
    background: #e74c3c !important;
  }

  /* ===== CREDIT ===== */
  #credit {
    position: fixed;
    bottom: 8px;
    right: 12px;
    font-size: 14px;
    color: #555;
    opacity: 0.8;
    user-select: none;
    pointer-events: none;
  }
</style>
</head>

<body>

<header>
  <button id="modeBtn" class="btn active">‚ö° Training Mode</button>
  <button id="timerBtn" class="btn secondary">‚è± 30s</button>
  <button id="checkBtn" class="btn secondary" disabled>Check Answers</button>
  <button id="resetBtn" class="btn">Reset</button>
  <div id="status">Score: 0 / 0</div>
</header>

<main>
  <div class="zone">
    <h2>Commissural</h2>
    <div class="drop-area" data-zone="commissural"></div>
  </div>

  <div class="zone">
    <h2>Association</h2>
    <div class="drop-area" data-zone="association"></div>
  </div>
</main>

<div id="options"></div>

<footer id="credit">
  Created by <strong>Roy Carmelli</strong>
</footer>

<script>
/* ===================== DATA ===================== */
const itemsData = [
  { label: "Between hemispheres", zone: "commissural" },
  { label: "CC", full: "Corpus Callosum", zone: "commissural" },
  { label: "AC", full: "Anterior Commissure", zone: "commissural" },
  { label: "PC", full: "Posterior Commissure", zone: "commissural" },
  { label: "Within the same hemisphere", zone: "association" },
  { label: "SLF", full: "Superior Longitudinal Fasciculus", zone: "association" },
  { label: "ILF", full: "Inferior Longitudinal Fasciculus", zone: "association" },
  { label: "IFOF", full: "Inferior Fronto-Occipital Fasciculus", zone: "association" },
  { label: "UNC", full: "Uncinate Fasciculus", zone: "association" },
  { label: "Fornix", zone: "association" }
];

let mode = "training";
let totalTries = 0;
let correctCount = 0;
let placedCount = 0;
let timer = 30;
let interval = null;
let locked = false;

/* ===================== ELEMENTS ===================== */
const optionsDiv = document.getElementById("options");
const statusDiv = document.getElementById("status");
const modeBtn = document.getElementById("modeBtn");
const timerBtn = document.getElementById("timerBtn");
const checkBtn = document.getElementById("checkBtn");
const resetBtn = document.getElementById("resetBtn");

/* ===================== INIT ===================== */
function init() {
  optionsDiv.innerHTML = "";
  document.querySelectorAll(".drop-area").forEach(z => z.innerHTML = "");
  correctCount = 0;
  totalTries = 0;
  placedCount = 0;
  locked = false;
  clearInterval(interval);
  interval = null;
  updateStatus();

  itemsData.forEach(item => {
    const el = document.createElement("div");
    el.className = "item";
    el.textContent = item.label;
    el.draggable = true;
    el.dataset.zone = item.zone;
    if (item.full) el.dataset.full = item.full;

    el.addEventListener("dragstart", e => {
      if (locked) e.preventDefault();
      else e.dataTransfer.setData("text/plain", el.outerHTML);
    });

    optionsDiv.appendChild(el);
  });

  checkBtn.disabled = true;
}

init();

/* ===================== DROP LOGIC ===================== */
document.querySelectorAll(".drop-area").forEach(area => {
  area.addEventListener("dragover", e => e.preventDefault());

  area.addEventListener("drop", e => {
    e.preventDefault();
    if (locked) return;

    const html = e.dataTransfer.getData("text/plain");
    if (!html) return;

    const temp = document.createElement("div");
    temp.innerHTML = html;
    const item = temp.firstChild;
    const correctZone = item.dataset.zone;
    const targetZone = area.dataset.zone;

    totalTries++;

    if (mode === "training") {
      if (correctZone === targetZone) {
        correctCount++;
        placedCount++;
        item.classList.add("correct");
        if (item.dataset.full) item.textContent += " ‚Äì " + item.dataset.full;
        item.draggable = false;
        area.appendChild(item);
        optionsDiv.querySelector(`[data-zone="${correctZone}"]`)?.remove();
      }
    } else {
      placedCount++;
      area.appendChild(item);
      if (placedCount === itemsData.length) checkBtn.disabled = false;
    }

    if (!interval && mode === "test") startTimer();
    updateStatus();
  });
});

/* ===================== TIMER ===================== */
function startTimer() {
  let timeLeft = timer;
  timerBtn.textContent = "‚è± " + timeLeft + "s";
  interval = setInterval(() => {
    timeLeft--;
    timerBtn.textContent = "‚è± " + timeLeft + "s";
    if (timeLeft <= 0) {
      clearInterval(interval);
      autoCheck();
    }
  }, 1000);
}

/* ===================== CHECK ===================== */
function autoCheck() {
  locked = true;
  let correct = 0;
  document.querySelectorAll(".drop-area .item").forEach(item => {
    const zone = item.dataset.zone;
    const parentZone = item.parentElement.dataset.zone;
    if (zone === parentZone) {
      item.classList.add("correct");
      correct++;
    } else {
      item.classList.add("wrong");
    }
  });
  statusDiv.textContent = `Checked. Correct: ${correct}/10 ‚úÖ ‚ùå`;
}

/* ===================== UI ===================== */
function updateStatus() {
  statusDiv.textContent = `Score: ${correctCount} / ${totalTries}`;
}

modeBtn.onclick = () => {
  mode = mode === "training" ? "test" : "training";
  modeBtn.textContent = mode === "training" ? "‚ö° Training Mode" : "üß™ Test Mode";
  init();
};

timerBtn.onclick = () => {
  if (mode !== "test") return;
  timer = timer === 30 ? 60 : timer === 60 ? 90 : 30;
  timerBtn.textContent = "‚è± " + timer + "s";
  init();
};

checkBtn.onclick = autoCheck;
resetBtn.onclick = init;
</script>

</body>
</html>
